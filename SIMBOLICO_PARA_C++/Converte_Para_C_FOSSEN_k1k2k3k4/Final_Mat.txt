
PWM(1) = (1501000*FX*cos(Th1) + 1501000*FY*sin(Th1) - 500000*FX*cos(Th1 - 2*Th2) - 500000*FX*cos(Th1 - 2*Th3) - 500000*FX*cos(Th1 - 2*Th4) + 500000*FY*sin(Th1 - 2*Th2) + 500000*FY*sin(Th1 - 2*Th3) + 500000*FY*sin(Th1 - 2*Th4) + 2001500000*FX*Lx^2*cos(Th1) + 2002000000*FX*Ly^2*cos(Th1) + 2002000000*FY*Lx^2*sin(Th1) + 2001500000*FY*Ly^2*sin(Th1) - 500000000*FX*Lx^2*cos(Th1 - 2*Th2) - 500500000*FX*Lx^2*cos(Th1 + 2*Th2) - 2000500000*FX*Lx^2*cos(Th1 - 2*Th3) - 500000000*FX*Lx^2*cos(Th1 - 2*Th4) - 500500000*FX*Lx^2*cos(Th1 + 2*Th4) + 500000*FX*Ly^2*cos(Th1 - 2*Th2) + 500500000*FX*Ly^2*cos(Th1 + 2*Th2) + 500000*FX*Ly^2*cos(Th1 - 2*Th3) + 500500000*FX*Ly^2*cos(Th1 + 2*Th3) - 1000000000*FX*Ly^2*cos(Th1 - 2*Th4) - 500000*FY*Lx^2*sin(Th1 - 2*Th2) - 500500000*FY*Lx^2*sin(Th1 + 2*Th2) + 1000000000*FY*Lx^2*sin(Th1 - 2*Th3) - 500000*FY*Lx^2*sin(Th1 - 2*Th4) - 500500000*FY*Lx^2*sin(Th1 + 2*Th4) + 500000000*FY*Ly^2*sin(Th1 - 2*Th2) + 500500000*FY*Ly^2*sin(Th1 + 2*Th2) + 500000000*FY*Ly^2*sin(Th1 - 2*Th3) + 500500000*FY*Ly^2*sin(Th1 + 2*Th3) + 2000500000*FY*Ly^2*sin(Th1 - 2*Th4) + 500000000*FX*Lx^2*cos(2*Th2 - Th1 + 2*Th3) + 500000000*FX*Lx^2*cos(2*Th3 - Th1 + 2*Th4) - 500000000*FX*Ly^2*cos(2*Th2 - Th1 + 2*Th4) - 500000000*FX*Ly^2*cos(2*Th3 - Th1 + 2*Th4) + 500000000*FY*Lx^2*sin(2*Th2 - Th1 + 2*Th3) + 500000000*FY*Lx^2*sin(2*Th3 - Th1 + 2*Th4) - 500000000*FY*Ly^2*sin(2*Th2 - Th1 + 2*Th4) - 500000000*FY*Ly^2*sin(2*Th3 - Th1 + 2*Th4) + 500000000*Ly*TN*cos(Th1 - 2*Th2 + 2*Th3) + 500000000*Ly*TN*cos(Th1 + 2*Th2 - 2*Th3) + 500000000*Ly*TN*cos(Th1 + 2*Th2 - 2*Th4) + 500000000*Ly*TN*cos(Th1 + 2*Th3 - 2*Th4) - 500000000*Lx*TN*sin(Th1 + 2*Th2 - 2*Th3) - 500000000*Lx*TN*sin(Th1 - 2*Th2 + 2*Th4) - 500000000*Lx*TN*sin(Th1 + 2*Th2 - 2*Th4) - 500000000*Lx*TN*sin(Th1 - 2*Th3 + 2*Th4) - 2003501000*Ly*TN*cos(Th1) + 2003501000*Lx*TN*sin(Th1) - 500500000*Ly*TN*cos(Th1 - 2*Th2) - 500500000*Ly*TN*cos(Th1 - 2*Th3) + 1000500000*Ly*TN*cos(Th1 - 2*Th4) + 500000000*FX*Lx^2*cos(Th1 + 2*Th2 - 2*Th3) + 500000000*FX*Lx^2*cos(Th1 - 2*Th3 + 2*Th4) - 500000000*FX*Ly^2*cos(Th1 - 2*Th2 + 2*Th3) - 500000000*FX*Ly^2*cos(Th1 + 2*Th2 - 2*Th3) - 500500000*Lx*TN*sin(Th1 - 2*Th2) + 1000500000*Lx*TN*sin(Th1 - 2*Th3) - 500500000*Lx*TN*sin(Th1 - 2*Th4) - 500000000*FY*Lx^2*sin(Th1 - 2*Th2 + 2*Th4) - 500000000*FY*Lx^2*sin(Th1 + 2*Th2 - 2*Th4) + 500000000*FY*Ly^2*sin(Th1 + 2*Th2 - 2*Th4) + 500000000*FY*Ly^2*sin(Th1 + 2*Th3 - 2*Th4) - 1000500000*FX*Lx*Ly*sin(Th1) - 500500000*FY*Lx*Ly*cos(Th1 - 2*Th2) + 1001000000*FY*Lx*Ly*cos(Th1 + 2*Th2) - 500000000*FY*Lx*Ly*cos(Th1 - 2*Th3) - 1000500000*FY*Lx*Ly*cos(Th1 + 2*Th3) + 2001000000*FY*Lx*Ly*cos(Th1 - 2*Th4) - 1000500000*FY*Lx*Ly*cos(Th1 + 2*Th4) + 500500000*FX*Lx*Ly*sin(Th1 - 2*Th2) - 1001000000*FX*Lx*Ly*sin(Th1 + 2*Th2) - 2001000000*FX*Lx*Ly*sin(Th1 - 2*Th3) + 1000500000*FX*Lx*Ly*sin(Th1 + 2*Th3) + 500000000*FX*Lx*Ly*sin(Th1 - 2*Th4) + 1000500000*FX*Lx*Ly*sin(Th1 + 2*Th4) + 1000000000*FY*Lx*Ly*cos(2*Th3 - Th1 + 2*Th4) - 1000000000*FX*Lx*Ly*sin(2*Th3 - Th1 + 2*Th4) - 500000000*FY*Lx*Ly*cos(Th1 - 2*Th2 + 2*Th4) + 1000000000*FY*Lx*Ly*cos(Th1 + 2*Th2 - 2*Th4) - 500000000*FY*Lx*Ly*cos(Th1 - 2*Th3 + 2*Th4) - 500000000*FX*Lx*Ly*sin(Th1 - 2*Th2 + 2*Th3) + 1000000000*FX*Lx*Ly*sin(Th1 + 2*Th2 - 2*Th3) - 500000000*FX*Lx*Ly*sin(Th1 + 2*Th3 - 2*Th4) - 1000500000*FY*Lx*Ly*cos(Th1))/(k1*(1002000500*Ly^2*cos(2*Th1) - 500000*cos(2*Th1 - 2*Th3) - 500000*cos(2*Th1 - 2*Th4) - 500000*cos(2*Th2 - 2*Th3) - 500000*cos(2*Th2 - 2*Th4) - 500000*cos(2*Th3 - 2*Th4) - 1002000500*Lx^2*cos(2*Th1) - 1002000500*Lx^2*cos(2*Th2) - 1002000500*Lx^2*cos(2*Th3) - 1002000500*Lx^2*cos(2*Th4) - 500000*cos(2*Th1 - 2*Th2) + 1002000500*Ly^2*cos(2*Th2) + 1002000500*Ly^2*cos(2*Th3) + 1002000500*Ly^2*cos(2*Th4) + 500000*Lx^2*cos(2*Th1 - 2*Th2) - 2000500000*Lx^2*cos(2*Th1 - 2*Th3) + 500000*Lx^2*cos(2*Th1 - 2*Th4) + 500000*Lx^2*cos(2*Th2 - 2*Th3) - 2000500000*Lx^2*cos(2*Th2 - 2*Th4) + 500000*Lx^2*cos(2*Th3 - 2*Th4) + 500000*Ly^2*cos(2*Th1 - 2*Th2) + 500000*Ly^2*cos(2*Th1 - 2*Th3) - 2000500000*Ly^2*cos(2*Th1 - 2*Th4) - 2000500000*Ly^2*cos(2*Th2 - 2*Th3) + 500000*Ly^2*cos(2*Th2 - 2*Th4) + 500000*Ly^2*cos(2*Th3 - 2*Th4) + 4007002000*Lx^2 + 4007002000*Ly^2 + 500000000*Lx^2*cos(2*Th2 - 2*Th1 + 2*Th3) + 500000000*Lx^2*cos(2*Th1 + 2*Th2 - 2*Th3) + 500000000*Lx^2*cos(2*Th1 - 2*Th2 + 2*Th4) + 500000000*Lx^2*cos(2*Th1 + 2*Th2 - 2*Th4) + 500000000*Lx^2*cos(2*Th3 - 2*Th1 + 2*Th4) + 500000000*Lx^2*cos(2*Th1 - 2*Th3 + 2*Th4) + 500000000*Lx^2*cos(2*Th3 - 2*Th2 + 2*Th4) + 500000000*Lx^2*cos(2*Th2 + 2*Th3 - 2*Th4) - 500000000*Ly^2*cos(2*Th1 - 2*Th2 + 2*Th3) - 500000000*Ly^2*cos(2*Th1 + 2*Th2 - 2*Th3) - 500000000*Ly^2*cos(2*Th2 - 2*Th1 + 2*Th4) - 500000000*Ly^2*cos(2*Th1 + 2*Th2 - 2*Th4) - 500000000*Ly^2*cos(2*Th3 - 2*Th1 + 2*Th4) - 500000000*Ly^2*cos(2*Th1 + 2*Th3 - 2*Th4) - 500000000*Ly^2*cos(2*Th3 - 2*Th2 + 2*Th4) - 500000000*Ly^2*cos(2*Th2 - 2*Th3 + 2*Th4) - 3004001000*Lx*Ly*sin(2*Th1) - 3004001000*Lx*Ly*sin(2*Th2) + 3004001000*Lx*Ly*sin(2*Th3) + 3004001000*Lx*Ly*sin(2*Th4) - 2001000000*Lx*Ly*sin(2*Th1 - 2*Th3) + 2001000000*Lx*Ly*sin(2*Th1 - 2*Th4) + 2001000000*Lx*Ly*sin(2*Th2 - 2*Th3) - 2001000000*Lx*Ly*sin(2*Th2 - 2*Th4) + 1000000000*Lx*Ly*sin(2*Th1 + 2*Th2 - 2*Th3) + 1000000000*Lx*Ly*sin(2*Th1 + 2*Th2 - 2*Th4) - 1000000000*Lx*Ly*sin(2*Th3 - 2*Th1 + 2*Th4) - 1000000000*Lx*Ly*sin(2*Th3 - 2*Th2 + 2*Th4) + 3004001));
PWM(2) = -(500000*FX*cos(Th2 - 2*Th3) - 1501000*FY*sin(Th2) - 1501000*FX*cos(Th2) + 500000*FX*cos(Th2 - 2*Th4) - 500000*FY*sin(Th2 - 2*Th3) - 500000*FY*sin(Th2 - 2*Th4) + 500000*FX*cos(2*Th1 - Th2) + 500000*FY*sin(2*Th1 - Th2) - 2001500000*FX*Lx^2*cos(Th2) - 2002000000*FX*Ly^2*cos(Th2) - 2002000000*FY*Lx^2*sin(Th2) - 2001500000*FY*Ly^2*sin(Th2) + 500500000*FX*Lx^2*cos(2*Th1 + Th2) + 500000000*FX*Lx^2*cos(Th2 - 2*Th3) + 500500000*FX*Lx^2*cos(Th2 + 2*Th3) + 2000500000*FX*Lx^2*cos(Th2 - 2*Th4) - 500500000*FX*Ly^2*cos(2*Th1 + Th2) + 1000000000*FX*Ly^2*cos(Th2 - 2*Th3) - 500000*FX*Ly^2*cos(Th2 - 2*Th4) - 500500000*FX*Ly^2*cos(Th2 + 2*Th4) - 500500000*Ly*TN*cos(2*Th1 - Th2) + 500500000*FY*Lx^2*sin(2*Th1 + Th2) + 500000*FY*Lx^2*sin(Th2 - 2*Th3) + 500500000*FY*Lx^2*sin(Th2 + 2*Th3) - 1000000000*FY*Lx^2*sin(Th2 - 2*Th4) - 500500000*FY*Ly^2*sin(2*Th1 + Th2) - 2000500000*FY*Ly^2*sin(Th2 - 2*Th3) - 500000000*FY*Ly^2*sin(Th2 - 2*Th4) - 500500000*FY*Ly^2*sin(Th2 + 2*Th4) - 500000000*FX*Lx^2*cos(2*Th1 - Th2 + 2*Th4) - 500000000*FX*Lx^2*cos(2*Th3 - Th2 + 2*Th4) + 500000000*FX*Ly^2*cos(2*Th1 - Th2 + 2*Th3) + 500000000*FX*Ly^2*cos(2*Th3 - Th2 + 2*Th4) + 500500000*Lx*TN*sin(2*Th1 - Th2) - 500000000*FY*Lx^2*sin(2*Th1 - Th2 + 2*Th4) - 500000000*FY*Lx^2*sin(2*Th3 - Th2 + 2*Th4) + 500000000*FY*Ly^2*sin(2*Th1 - Th2 + 2*Th3) + 500000000*FY*Ly^2*sin(2*Th3 - Th2 + 2*Th4) + 500000000*FX*Lx^2*cos(2*Th1 - Th2) - 500000*FX*Ly^2*cos(2*Th1 - Th2) + 500000000*Ly*TN*cos(2*Th1 + Th2 - 2*Th3) + 500000000*Ly*TN*cos(Th2 - 2*Th1 + 2*Th4) + 500000000*Ly*TN*cos(2*Th1 + Th2 - 2*Th4) + 500000000*Ly*TN*cos(Th2 - 2*Th3 + 2*Th4) - 500000*FY*Lx^2*sin(2*Th1 - Th2) + 500000000*FY*Ly^2*sin(2*Th1 - Th2) - 500000000*Lx*TN*sin(Th2 - 2*Th1 + 2*Th3) - 500000000*Lx*TN*sin(2*Th1 + Th2 - 2*Th3) - 500000000*Lx*TN*sin(2*Th1 + Th2 - 2*Th4) - 500000000*Lx*TN*sin(Th2 + 2*Th3 - 2*Th4) - 2003501000*Ly*TN*cos(Th2) + 2003501000*Lx*TN*sin(Th2) + 1000500000*Ly*TN*cos(Th2 - 2*Th3) - 500500000*Ly*TN*cos(Th2 - 2*Th4) - 500000000*FX*Lx^2*cos(2*Th1 + Th2 - 2*Th4) - 500000000*FX*Lx^2*cos(Th2 + 2*Th3 - 2*Th4) + 500000000*FX*Ly^2*cos(Th2 - 2*Th1 + 2*Th4) + 500000000*FX*Ly^2*cos(2*Th1 + Th2 - 2*Th4) - 500500000*Lx*TN*sin(Th2 - 2*Th3) + 1000500000*Lx*TN*sin(Th2 - 2*Th4) + 500000000*FY*Lx^2*sin(Th2 - 2*Th1 + 2*Th3) + 500000000*FY*Lx^2*sin(2*Th1 + Th2 - 2*Th3) - 500000000*FY*Ly^2*sin(2*Th1 + Th2 - 2*Th3) - 500000000*FY*Ly^2*sin(Th2 - 2*Th3 + 2*Th4) + 1000500000*FX*Lx*Ly*sin(Th2) - 1001000000*FY*Lx*Ly*cos(2*Th1 + Th2) - 2001000000*FY*Lx*Ly*cos(Th2 - 2*Th3) + 1000500000*FY*Lx*Ly*cos(Th2 + 2*Th3) + 500000000*FY*Lx*Ly*cos(Th2 - 2*Th4) + 1000500000*FY*Lx*Ly*cos(Th2 + 2*Th4) + 1001000000*FX*Lx*Ly*sin(2*Th1 + Th2) - 500000000*FX*Lx*Ly*sin(Th2 - 2*Th3) - 1000500000*FX*Lx*Ly*sin(Th2 + 2*Th3) + 2001000000*FX*Lx*Ly*sin(Th2 - 2*Th4) - 1000500000*FX*Lx*Ly*sin(Th2 + 2*Th4) - 1000000000*FY*Lx*Ly*cos(2*Th3 - Th2 + 2*Th4) + 1000000000*FX*Lx*Ly*sin(2*Th3 - Th2 + 2*Th4) + 500500000*FY*Lx*Ly*cos(2*Th1 - Th2) + 500500000*FX*Lx*Ly*sin(2*Th1 - Th2) + 500000000*FY*Lx*Ly*cos(Th2 - 2*Th1 + 2*Th3) - 1000000000*FY*Lx*Ly*cos(2*Th1 + Th2 - 2*Th3) + 500000000*FY*Lx*Ly*cos(Th2 + 2*Th3 - 2*Th4) + 500000000*FX*Lx*Ly*sin(Th2 - 2*Th1 + 2*Th4) - 1000000000*FX*Lx*Ly*sin(2*Th1 + Th2 - 2*Th4) + 500000000*FX*Lx*Ly*sin(Th2 - 2*Th3 + 2*Th4) + 1000500000*FY*Lx*Ly*cos(Th2))/(k1*(1002000500*Ly^2*cos(2*Th1) - 500000*cos(2*Th1 - 2*Th3) - 500000*cos(2*Th1 - 2*Th4) - 500000*cos(2*Th2 - 2*Th3) - 500000*cos(2*Th2 - 2*Th4) - 500000*cos(2*Th3 - 2*Th4) - 1002000500*Lx^2*cos(2*Th1) - 1002000500*Lx^2*cos(2*Th2) - 1002000500*Lx^2*cos(2*Th3) - 1002000500*Lx^2*cos(2*Th4) - 500000*cos(2*Th1 - 2*Th2) + 1002000500*Ly^2*cos(2*Th2) + 1002000500*Ly^2*cos(2*Th3) + 1002000500*Ly^2*cos(2*Th4) + 500000*Lx^2*cos(2*Th1 - 2*Th2) - 2000500000*Lx^2*cos(2*Th1 - 2*Th3) + 500000*Lx^2*cos(2*Th1 - 2*Th4) + 500000*Lx^2*cos(2*Th2 - 2*Th3) - 2000500000*Lx^2*cos(2*Th2 - 2*Th4) + 500000*Lx^2*cos(2*Th3 - 2*Th4) + 500000*Ly^2*cos(2*Th1 - 2*Th2) + 500000*Ly^2*cos(2*Th1 - 2*Th3) - 2000500000*Ly^2*cos(2*Th1 - 2*Th4) - 2000500000*Ly^2*cos(2*Th2 - 2*Th3) + 500000*Ly^2*cos(2*Th2 - 2*Th4) + 500000*Ly^2*cos(2*Th3 - 2*Th4) + 4007002000*Lx^2 + 4007002000*Ly^2 + 500000000*Lx^2*cos(2*Th2 - 2*Th1 + 2*Th3) + 500000000*Lx^2*cos(2*Th1 + 2*Th2 - 2*Th3) + 500000000*Lx^2*cos(2*Th1 - 2*Th2 + 2*Th4) + 500000000*Lx^2*cos(2*Th1 + 2*Th2 - 2*Th4) + 500000000*Lx^2*cos(2*Th3 - 2*Th1 + 2*Th4) + 500000000*Lx^2*cos(2*Th1 - 2*Th3 + 2*Th4) + 500000000*Lx^2*cos(2*Th3 - 2*Th2 + 2*Th4) + 500000000*Lx^2*cos(2*Th2 + 2*Th3 - 2*Th4) - 500000000*Ly^2*cos(2*Th1 - 2*Th2 + 2*Th3) - 500000000*Ly^2*cos(2*Th1 + 2*Th2 - 2*Th3) - 500000000*Ly^2*cos(2*Th2 - 2*Th1 + 2*Th4) - 500000000*Ly^2*cos(2*Th1 + 2*Th2 - 2*Th4) - 500000000*Ly^2*cos(2*Th3 - 2*Th1 + 2*Th4) - 500000000*Ly^2*cos(2*Th1 + 2*Th3 - 2*Th4) - 500000000*Ly^2*cos(2*Th3 - 2*Th2 + 2*Th4) - 500000000*Ly^2*cos(2*Th2 - 2*Th3 + 2*Th4) - 3004001000*Lx*Ly*sin(2*Th1) - 3004001000*Lx*Ly*sin(2*Th2) + 3004001000*Lx*Ly*sin(2*Th3) + 3004001000*Lx*Ly*sin(2*Th4) - 2001000000*Lx*Ly*sin(2*Th1 - 2*Th3) + 2001000000*Lx*Ly*sin(2*Th1 - 2*Th4) + 2001000000*Lx*Ly*sin(2*Th2 - 2*Th3) - 2001000000*Lx*Ly*sin(2*Th2 - 2*Th4) + 1000000000*Lx*Ly*sin(2*Th1 + 2*Th2 - 2*Th3) + 1000000000*Lx*Ly*sin(2*Th1 + 2*Th2 - 2*Th4) - 1000000000*Lx*Ly*sin(2*Th3 - 2*Th1 + 2*Th4) - 1000000000*Lx*Ly*sin(2*Th3 - 2*Th2 + 2*Th4) + 3004001));
PWM(3) = -(500000*FX*cos(Th3 - 2*Th4) - 1501000*FY*sin(Th3) - 1501000*FX*cos(Th3) - 500000*FY*sin(Th3 - 2*Th4) + 500000*FX*cos(2*Th1 - Th3) + 500000*FX*cos(2*Th2 - Th3) + 500000*FY*sin(2*Th1 - Th3) + 500000*FY*sin(2*Th2 - Th3) - 2001500000*FX*Lx^2*cos(Th3) - 2002000000*FX*Ly^2*cos(Th3) - 2002000000*FY*Lx^2*sin(Th3) - 2001500000*FY*Ly^2*sin(Th3) + 500500000*FX*Lx^2*cos(2*Th2 + Th3) + 500000000*FX*Lx^2*cos(Th3 - 2*Th4) + 500500000*FX*Lx^2*cos(Th3 + 2*Th4) - 500500000*FX*Ly^2*cos(2*Th1 + Th3) - 500000*FX*Ly^2*cos(Th3 - 2*Th4) - 500500000*FX*Ly^2*cos(Th3 + 2*Th4) - 500500000*Ly*TN*cos(2*Th1 - Th3) + 1000500000*Ly*TN*cos(2*Th2 - Th3) + 500500000*FY*Lx^2*sin(2*Th2 + Th3) + 500000*FY*Lx^2*sin(Th3 - 2*Th4) + 500500000*FY*Lx^2*sin(Th3 + 2*Th4) - 500500000*FY*Ly^2*sin(2*Th1 + Th3) - 500000000*FY*Ly^2*sin(Th3 - 2*Th4) - 500500000*FY*Ly^2*sin(Th3 + 2*Th4) - 500000000*FX*Lx^2*cos(2*Th1 + 2*Th2 - Th3) - 500000000*FX*Lx^2*cos(2*Th1 - Th3 + 2*Th4) + 500000000*FX*Ly^2*cos(2*Th1 + 2*Th2 - Th3) + 500000000*FX*Ly^2*cos(2*Th2 - Th3 + 2*Th4) + 1000500000*Lx*TN*sin(2*Th1 - Th3) - 500500000*Lx*TN*sin(2*Th2 - Th3) - 500000000*FY*Lx^2*sin(2*Th1 + 2*Th2 - Th3) - 500000000*FY*Lx^2*sin(2*Th1 - Th3 + 2*Th4) + 500000000*FY*Ly^2*sin(2*Th1 + 2*Th2 - Th3) + 500000000*FY*Ly^2*sin(2*Th2 - Th3 + 2*Th4) + 2000500000*FX*Lx^2*cos(2*Th1 - Th3) + 500000000*FX*Lx^2*cos(2*Th2 - Th3) - 500000*FX*Ly^2*cos(2*Th1 - Th3) + 1000000000*FX*Ly^2*cos(2*Th2 - Th3) + 500000000*Ly*TN*cos(2*Th1 - 2*Th2 + Th3) + 500000000*Ly*TN*cos(Th3 - 2*Th1 + 2*Th4) + 500000000*Ly*TN*cos(2*Th1 + Th3 - 2*Th4) + 500000000*Ly*TN*cos(Th3 - 2*Th2 + 2*Th4) + 1000000000*FY*Lx^2*sin(2*Th1 - Th3) - 500000*FY*Lx^2*sin(2*Th2 - Th3) + 500000000*FY*Ly^2*sin(2*Th1 - Th3) + 2000500000*FY*Ly^2*sin(2*Th2 - Th3) + 500000000*Lx*TN*sin(2*Th2 - 2*Th1 + Th3) + 500000000*Lx*TN*sin(Th3 - 2*Th1 + 2*Th4) + 500000000*Lx*TN*sin(Th3 - 2*Th2 + 2*Th4) + 500000000*Lx*TN*sin(2*Th2 + Th3 - 2*Th4) - 2003501000*Ly*TN*cos(Th3) - 2003501000*Lx*TN*sin(Th3) - 500500000*Ly*TN*cos(Th3 - 2*Th4) - 500000000*FX*Lx^2*cos(2*Th2 - 2*Th1 + Th3) - 500000000*FX*Lx^2*cos(Th3 - 2*Th1 + 2*Th4) + 500000000*FX*Ly^2*cos(Th3 - 2*Th1 + 2*Th4) + 500000000*FX*Ly^2*cos(2*Th1 + Th3 - 2*Th4) + 500500000*Lx*TN*sin(Th3 - 2*Th4) + 500000000*FY*Lx^2*sin(Th3 - 2*Th2 + 2*Th4) + 500000000*FY*Lx^2*sin(2*Th2 + Th3 - 2*Th4) - 500000000*FY*Ly^2*sin(2*Th1 - 2*Th2 + Th3) - 500000000*FY*Ly^2*sin(Th3 - 2*Th2 + 2*Th4) - 1000500000*FX*Lx*Ly*sin(Th3) - 1000500000*FY*Lx*Ly*cos(2*Th1 + Th3) - 1000500000*FY*Lx*Ly*cos(2*Th2 + Th3) - 500500000*FY*Lx*Ly*cos(Th3 - 2*Th4) + 1001000000*FY*Lx*Ly*cos(Th3 + 2*Th4) + 1000500000*FX*Lx*Ly*sin(2*Th1 + Th3) + 1000500000*FX*Lx*Ly*sin(2*Th2 + Th3) + 500500000*FX*Lx*Ly*sin(Th3 - 2*Th4) - 1001000000*FX*Lx*Ly*sin(Th3 + 2*Th4) + 1000000000*FY*Lx*Ly*cos(2*Th1 + 2*Th2 - Th3) - 1000000000*FX*Lx*Ly*sin(2*Th1 + 2*Th2 - Th3) - 500000000*FY*Lx*Ly*cos(2*Th1 - Th3) + 2001000000*FY*Lx*Ly*cos(2*Th2 - Th3) + 2001000000*FX*Lx*Ly*sin(2*Th1 - Th3) - 500000000*FX*Lx*Ly*sin(2*Th2 - Th3) - 500000000*FY*Lx*Ly*cos(2*Th2 - 2*Th1 + Th3) + 1000000000*FY*Lx*Ly*cos(Th3 - 2*Th2 + 2*Th4) - 500000000*FY*Lx*Ly*cos(2*Th2 + Th3 - 2*Th4) - 500000000*FX*Lx*Ly*sin(2*Th1 - 2*Th2 + Th3) + 1000000000*FX*Lx*Ly*sin(Th3 - 2*Th1 + 2*Th4) - 500000000*FX*Lx*Ly*sin(2*Th1 + Th3 - 2*Th4) - 1000500000*FY*Lx*Ly*cos(Th3))/(k1*(1002000500*Ly^2*cos(2*Th1) - 500000*cos(2*Th1 - 2*Th3) - 500000*cos(2*Th1 - 2*Th4) - 500000*cos(2*Th2 - 2*Th3) - 500000*cos(2*Th2 - 2*Th4) - 500000*cos(2*Th3 - 2*Th4) - 1002000500*Lx^2*cos(2*Th1) - 1002000500*Lx^2*cos(2*Th2) - 1002000500*Lx^2*cos(2*Th3) - 1002000500*Lx^2*cos(2*Th4) - 500000*cos(2*Th1 - 2*Th2) + 1002000500*Ly^2*cos(2*Th2) + 1002000500*Ly^2*cos(2*Th3) + 1002000500*Ly^2*cos(2*Th4) + 500000*Lx^2*cos(2*Th1 - 2*Th2) - 2000500000*Lx^2*cos(2*Th1 - 2*Th3) + 500000*Lx^2*cos(2*Th1 - 2*Th4) + 500000*Lx^2*cos(2*Th2 - 2*Th3) - 2000500000*Lx^2*cos(2*Th2 - 2*Th4) + 500000*Lx^2*cos(2*Th3 - 2*Th4) + 500000*Ly^2*cos(2*Th1 - 2*Th2) + 500000*Ly^2*cos(2*Th1 - 2*Th3) - 2000500000*Ly^2*cos(2*Th1 - 2*Th4) - 2000500000*Ly^2*cos(2*Th2 - 2*Th3) + 500000*Ly^2*cos(2*Th2 - 2*Th4) + 500000*Ly^2*cos(2*Th3 - 2*Th4) + 4007002000*Lx^2 + 4007002000*Ly^2 + 500000000*Lx^2*cos(2*Th2 - 2*Th1 + 2*Th3) + 500000000*Lx^2*cos(2*Th1 + 2*Th2 - 2*Th3) + 500000000*Lx^2*cos(2*Th1 - 2*Th2 + 2*Th4) + 500000000*Lx^2*cos(2*Th1 + 2*Th2 - 2*Th4) + 500000000*Lx^2*cos(2*Th3 - 2*Th1 + 2*Th4) + 500000000*Lx^2*cos(2*Th1 - 2*Th3 + 2*Th4) + 500000000*Lx^2*cos(2*Th3 - 2*Th2 + 2*Th4) + 500000000*Lx^2*cos(2*Th2 + 2*Th3 - 2*Th4) - 500000000*Ly^2*cos(2*Th1 - 2*Th2 + 2*Th3) - 500000000*Ly^2*cos(2*Th1 + 2*Th2 - 2*Th3) - 500000000*Ly^2*cos(2*Th2 - 2*Th1 + 2*Th4) - 500000000*Ly^2*cos(2*Th1 + 2*Th2 - 2*Th4) - 500000000*Ly^2*cos(2*Th3 - 2*Th1 + 2*Th4) - 500000000*Ly^2*cos(2*Th1 + 2*Th3 - 2*Th4) - 500000000*Ly^2*cos(2*Th3 - 2*Th2 + 2*Th4) - 500000000*Ly^2*cos(2*Th2 - 2*Th3 + 2*Th4) - 3004001000*Lx*Ly*sin(2*Th1) - 3004001000*Lx*Ly*sin(2*Th2) + 3004001000*Lx*Ly*sin(2*Th3) + 3004001000*Lx*Ly*sin(2*Th4) - 2001000000*Lx*Ly*sin(2*Th1 - 2*Th3) + 2001000000*Lx*Ly*sin(2*Th1 - 2*Th4) + 2001000000*Lx*Ly*sin(2*Th2 - 2*Th3) - 2001000000*Lx*Ly*sin(2*Th2 - 2*Th4) + 1000000000*Lx*Ly*sin(2*Th1 + 2*Th2 - 2*Th3) + 1000000000*Lx*Ly*sin(2*Th1 + 2*Th2 - 2*Th4) - 1000000000*Lx*Ly*sin(2*Th3 - 2*Th1 + 2*Th4) - 1000000000*Lx*Ly*sin(2*Th3 - 2*Th2 + 2*Th4) + 3004001));
PWM(4) = (1501000*FX*cos(Th4) + 1501000*FY*sin(Th4) - 500000*FX*cos(2*Th1 - Th4) - 500000*FX*cos(2*Th2 - Th4) - 500000*FX*cos(2*Th3 - Th4) - 500000*FY*sin(2*Th1 - Th4) - 500000*FY*sin(2*Th2 - Th4) - 500000*FY*sin(2*Th3 - Th4) + 2001500000*FX*Lx^2*cos(Th4) + 2002000000*FX*Ly^2*cos(Th4) + 2002000000*FY*Lx^2*sin(Th4) + 2001500000*FY*Ly^2*sin(Th4) - 500500000*FX*Lx^2*cos(2*Th1 + Th4) - 500500000*FX*Lx^2*cos(2*Th3 + Th4) + 500500000*FX*Ly^2*cos(2*Th2 + Th4) + 500500000*FX*Ly^2*cos(2*Th3 + Th4) + 1000500000*Ly*TN*cos(2*Th1 - Th4) - 500500000*Ly*TN*cos(2*Th2 - Th4) - 500500000*Ly*TN*cos(2*Th3 - Th4) - 500500000*FY*Lx^2*sin(2*Th1 + Th4) - 500500000*FY*Lx^2*sin(2*Th3 + Th4) + 500500000*FY*Ly^2*sin(2*Th2 + Th4) + 500500000*FY*Ly^2*sin(2*Th3 + Th4) + 500000000*FX*Lx^2*cos(2*Th1 + 2*Th2 - Th4) + 500000000*FX*Lx^2*cos(2*Th2 + 2*Th3 - Th4) - 500000000*FX*Ly^2*cos(2*Th1 + 2*Th2 - Th4) - 500000000*FX*Ly^2*cos(2*Th1 + 2*Th3 - Th4) - 500500000*Lx*TN*sin(2*Th1 - Th4) + 1000500000*Lx*TN*sin(2*Th2 - Th4) - 500500000*Lx*TN*sin(2*Th3 - Th4) + 500000000*FY*Lx^2*sin(2*Th1 + 2*Th2 - Th4) + 500000000*FY*Lx^2*sin(2*Th2 + 2*Th3 - Th4) - 500000000*FY*Ly^2*sin(2*Th1 + 2*Th2 - Th4) - 500000000*FY*Ly^2*sin(2*Th1 + 2*Th3 - Th4) - 500000000*FX*Lx^2*cos(2*Th1 - Th4) - 2000500000*FX*Lx^2*cos(2*Th2 - Th4) - 500000000*FX*Lx^2*cos(2*Th3 - Th4) - 1000000000*FX*Ly^2*cos(2*Th1 - Th4) + 500000*FX*Ly^2*cos(2*Th2 - Th4) + 500000*FX*Ly^2*cos(2*Th3 - Th4) + 500000000*Ly*TN*cos(2*Th2 - 2*Th1 + Th4) + 500000000*Ly*TN*cos(2*Th3 - 2*Th1 + Th4) + 500000000*Ly*TN*cos(2*Th3 - 2*Th2 + Th4) + 500000000*Ly*TN*cos(2*Th2 - 2*Th3 + Th4) + 500000*FY*Lx^2*sin(2*Th1 - Th4) - 1000000000*FY*Lx^2*sin(2*Th2 - Th4) + 500000*FY*Lx^2*sin(2*Th3 - Th4) - 2000500000*FY*Ly^2*sin(2*Th1 - Th4) - 500000000*FY*Ly^2*sin(2*Th2 - Th4) - 500000000*FY*Ly^2*sin(2*Th3 - Th4) + 500000000*Lx*TN*sin(2*Th1 - 2*Th2 + Th4) + 500000000*Lx*TN*sin(2*Th3 - 2*Th1 + Th4) + 500000000*Lx*TN*sin(2*Th1 - 2*Th3 + Th4) + 500000000*Lx*TN*sin(2*Th3 - 2*Th2 + Th4) - 2003501000*Ly*TN*cos(Th4) - 2003501000*Lx*TN*sin(Th4) + 500000000*FX*Lx^2*cos(2*Th1 - 2*Th2 + Th4) + 500000000*FX*Lx^2*cos(2*Th3 - 2*Th2 + Th4) - 500000000*FX*Ly^2*cos(2*Th3 - 2*Th2 + Th4) - 500000000*FX*Ly^2*cos(2*Th2 - 2*Th3 + Th4) - 500000000*FY*Lx^2*sin(2*Th3 - 2*Th1 + Th4) - 500000000*FY*Lx^2*sin(2*Th1 - 2*Th3 + Th4) + 500000000*FY*Ly^2*sin(2*Th2 - 2*Th1 + Th4) + 500000000*FY*Ly^2*sin(2*Th3 - 2*Th1 + Th4) + 1000500000*FX*Lx*Ly*sin(Th4) + 1000500000*FY*Lx*Ly*cos(2*Th1 + Th4) + 1000500000*FY*Lx*Ly*cos(2*Th2 + Th4) - 1001000000*FY*Lx*Ly*cos(2*Th3 + Th4) - 1000500000*FX*Lx*Ly*sin(2*Th1 + Th4) - 1000500000*FX*Lx*Ly*sin(2*Th2 + Th4) + 1001000000*FX*Lx*Ly*sin(2*Th3 + Th4) - 1000000000*FY*Lx*Ly*cos(2*Th1 + 2*Th2 - Th4) + 1000000000*FX*Lx*Ly*sin(2*Th1 + 2*Th2 - Th4) - 2001000000*FY*Lx*Ly*cos(2*Th1 - Th4) + 500000000*FY*Lx*Ly*cos(2*Th2 - Th4) + 500500000*FY*Lx*Ly*cos(2*Th3 - Th4) + 500000000*FX*Lx*Ly*sin(2*Th1 - Th4) - 2001000000*FX*Lx*Ly*sin(2*Th2 - Th4) + 500500000*FX*Lx*Ly*sin(2*Th3 - Th4) + 500000000*FY*Lx*Ly*cos(2*Th1 - 2*Th2 + Th4) - 1000000000*FY*Lx*Ly*cos(2*Th3 - 2*Th1 + Th4) + 500000000*FY*Lx*Ly*cos(2*Th1 - 2*Th3 + Th4) + 500000000*FX*Lx*Ly*sin(2*Th2 - 2*Th1 + Th4) - 1000000000*FX*Lx*Ly*sin(2*Th3 - 2*Th2 + Th4) + 500000000*FX*Lx*Ly*sin(2*Th2 - 2*Th3 + Th4) + 1000500000*FY*Lx*Ly*cos(Th4))/(k1*(1002000500*Ly^2*cos(2*Th1) - 500000*cos(2*Th1 - 2*Th3) - 500000*cos(2*Th1 - 2*Th4) - 500000*cos(2*Th2 - 2*Th3) - 500000*cos(2*Th2 - 2*Th4) - 500000*cos(2*Th3 - 2*Th4) - 1002000500*Lx^2*cos(2*Th1) - 1002000500*Lx^2*cos(2*Th2) - 1002000500*Lx^2*cos(2*Th3) - 1002000500*Lx^2*cos(2*Th4) - 500000*cos(2*Th1 - 2*Th2) + 1002000500*Ly^2*cos(2*Th2) + 1002000500*Ly^2*cos(2*Th3) + 1002000500*Ly^2*cos(2*Th4) + 500000*Lx^2*cos(2*Th1 - 2*Th2) - 2000500000*Lx^2*cos(2*Th1 - 2*Th3) + 500000*Lx^2*cos(2*Th1 - 2*Th4) + 500000*Lx^2*cos(2*Th2 - 2*Th3) - 2000500000*Lx^2*cos(2*Th2 - 2*Th4) + 500000*Lx^2*cos(2*Th3 - 2*Th4) + 500000*Ly^2*cos(2*Th1 - 2*Th2) + 500000*Ly^2*cos(2*Th1 - 2*Th3) - 2000500000*Ly^2*cos(2*Th1 - 2*Th4) - 2000500000*Ly^2*cos(2*Th2 - 2*Th3) + 500000*Ly^2*cos(2*Th2 - 2*Th4) + 500000*Ly^2*cos(2*Th3 - 2*Th4) + 4007002000*Lx^2 + 4007002000*Ly^2 + 500000000*Lx^2*cos(2*Th2 - 2*Th1 + 2*Th3) + 500000000*Lx^2*cos(2*Th1 + 2*Th2 - 2*Th3) + 500000000*Lx^2*cos(2*Th1 - 2*Th2 + 2*Th4) + 500000000*Lx^2*cos(2*Th1 + 2*Th2 - 2*Th4) + 500000000*Lx^2*cos(2*Th3 - 2*Th1 + 2*Th4) + 500000000*Lx^2*cos(2*Th1 - 2*Th3 + 2*Th4) + 500000000*Lx^2*cos(2*Th3 - 2*Th2 + 2*Th4) + 500000000*Lx^2*cos(2*Th2 + 2*Th3 - 2*Th4) - 500000000*Ly^2*cos(2*Th1 - 2*Th2 + 2*Th3) - 500000000*Ly^2*cos(2*Th1 + 2*Th2 - 2*Th3) - 500000000*Ly^2*cos(2*Th2 - 2*Th1 + 2*Th4) - 500000000*Ly^2*cos(2*Th1 + 2*Th2 - 2*Th4) - 500000000*Ly^2*cos(2*Th3 - 2*Th1 + 2*Th4) - 500000000*Ly^2*cos(2*Th1 + 2*Th3 - 2*Th4) - 500000000*Ly^2*cos(2*Th3 - 2*Th2 + 2*Th4) - 500000000*Ly^2*cos(2*Th2 - 2*Th3 + 2*Th4) - 3004001000*Lx*Ly*sin(2*Th1) - 3004001000*Lx*Ly*sin(2*Th2) + 3004001000*Lx*Ly*sin(2*Th3) + 3004001000*Lx*Ly*sin(2*Th4) - 2001000000*Lx*Ly*sin(2*Th1 - 2*Th3) + 2001000000*Lx*Ly*sin(2*Th1 - 2*Th4) + 2001000000*Lx*Ly*sin(2*Th2 - 2*Th3) - 2001000000*Lx*Ly*sin(2*Th2 - 2*Th4) + 1000000000*Lx*Ly*sin(2*Th1 + 2*Th2 - 2*Th3) + 1000000000*Lx*Ly*sin(2*Th1 + 2*Th2 - 2*Th4) - 1000000000*Lx*Ly*sin(2*Th3 - 2*Th1 + 2*Th4) - 1000000000*Lx*Ly*sin(2*Th3 - 2*Th2 + 2*Th4) + 3004001));


theta(1) = atan2((TN*(Lx*PWM1*PWM2^2 + Lx*PWM1*PWM4^2))/(2*k1*(Lx^2*PWM1^2*PWM2^2 + Lx^2*PWM1^2*PWM4^2 + Lx^2*PWM2^2*PWM3^2 + Lx^2*PWM3^2*PWM4^2 + Ly^2*PWM1^2*PWM2^2 + Ly^2*PWM1^2*PWM3^2 + Ly^2*PWM2^2*PWM4^2 + Ly^2*PWM3^2*PWM4^2)) + (FY*(Lx^2*PWM1*PWM2^4 + Lx^2*PWM1*PWM4^4 + Lx^2*PWM1^3*PWM2^2 + Lx^2*PWM1^3*PWM4^2 + 2*Ly^2*PWM1^3*PWM2^2 + 2*Ly^2*PWM1^3*PWM3^2 + Lx^2*PWM1*PWM2^2*PWM3^2 + 2*Lx^2*PWM1*PWM2^2*PWM4^2 + Lx^2*PWM1*PWM3^2*PWM4^2 + 2*Ly^2*PWM1*PWM2^2*PWM4^2 + 2*Ly^2*PWM1*PWM3^2*PWM4^2))/(2*k1*(PWM1^2 + PWM2^2 + PWM3^2 + PWM4^2)*(Lx^2*PWM1^2*PWM2^2 + Lx^2*PWM1^2*PWM4^2 + Lx^2*PWM2^2*PWM3^2 + Lx^2*PWM3^2*PWM4^2 + Ly^2*PWM1^2*PWM2^2 + Ly^2*PWM1^2*PWM3^2 + Ly^2*PWM2^2*PWM4^2 + Ly^2*PWM3^2*PWM4^2)) + (FX*(Lx*PWM1*PWM2^2 + Lx*PWM1*PWM4^2)*(Ly*PWM1^2 - Ly*PWM2^2 - Ly*PWM3^2 + Ly*PWM4^2))/(2*k1*(PWM1^2 + PWM2^2 + PWM3^2 + PWM4^2)*(Lx^2*PWM1^2*PWM2^2 + Lx^2*PWM1^2*PWM4^2 + Lx^2*PWM2^2*PWM3^2 + Lx^2*PWM3^2*PWM4^2 + Ly^2*PWM1^2*PWM2^2 + Ly^2*PWM1^2*PWM3^2 + Ly^2*PWM2^2*PWM4^2 + Ly^2*PWM3^2*PWM4^2)), (FX*(Ly^2*PWM1*PWM2^4 + Ly^2*PWM1*PWM3^4 + 2*Lx^2*PWM1^3*PWM2^2 + 2*Lx^2*PWM1^3*PWM4^2 + Ly^2*PWM1^3*PWM2^2 + Ly^2*PWM1^3*PWM3^2 + 2*Lx^2*PWM1*PWM2^2*PWM3^2 + 2*Lx^2*PWM1*PWM3^2*PWM4^2 + 2*Ly^2*PWM1*PWM2^2*PWM3^2 + Ly^2*PWM1*PWM2^2*PWM4^2 + Ly^2*PWM1*PWM3^2*PWM4^2))/(2*k1*(PWM1^2 + PWM2^2 + PWM3^2 + PWM4^2)*(Lx^2*PWM1^2*PWM2^2 + Lx^2*PWM1^2*PWM4^2 + Lx^2*PWM2^2*PWM3^2 + Lx^2*PWM3^2*PWM4^2 + Ly^2*PWM1^2*PWM2^2 + Ly^2*PWM1^2*PWM3^2 + Ly^2*PWM2^2*PWM4^2 + Ly^2*PWM3^2*PWM4^2)) - (TN*(Ly*PWM1*PWM2^2 + Ly*PWM1*PWM3^2))/(2*k1*(Lx^2*PWM1^2*PWM2^2 + Lx^2*PWM1^2*PWM4^2 + Lx^2*PWM2^2*PWM3^2 + Lx^2*PWM3^2*PWM4^2 + Ly^2*PWM1^2*PWM2^2 + Ly^2*PWM1^2*PWM3^2 + Ly^2*PWM2^2*PWM4^2 + Ly^2*PWM3^2*PWM4^2)) + (FY*(Ly*PWM1*PWM2^2 + Ly*PWM1*PWM3^2)*(Lx*PWM1^2 - Lx*PWM2^2 + Lx*PWM3^2 - Lx*PWM4^2))/(2*k1*(PWM1^2 + PWM2^2 + PWM3^2 + PWM4^2)*(Lx^2*PWM1^2*PWM2^2 + Lx^2*PWM1^2*PWM4^2 + Lx^2*PWM2^2*PWM3^2 + Lx^2*PWM3^2*PWM4^2 + Ly^2*PWM1^2*PWM2^2 + Ly^2*PWM1^2*PWM3^2 + Ly^2*PWM2^2*PWM4^2 + Ly^2*PWM3^2*PWM4^2)));
theta(2) = atan2((FY*(Lx^2*PWM1^4*PWM2 + Lx^2*PWM2*PWM3^4 + Lx^2*PWM1^2*PWM2^3 + Lx^2*PWM2^3*PWM3^2 + 2*Ly^2*PWM1^2*PWM2^3 + 2*Ly^2*PWM2^3*PWM4^2 + 2*Lx^2*PWM1^2*PWM2*PWM3^2 + Lx^2*PWM1^2*PWM2*PWM4^2 + Lx^2*PWM2*PWM3^2*PWM4^2 + 2*Ly^2*PWM1^2*PWM2*PWM3^2 + 2*Ly^2*PWM2*PWM3^2*PWM4^2))/(2*k1*(PWM1^2 + PWM2^2 + PWM3^2 + PWM4^2)*(Lx^2*PWM1^2*PWM2^2 + Lx^2*PWM1^2*PWM4^2 + Lx^2*PWM2^2*PWM3^2 + Lx^2*PWM3^2*PWM4^2 + Ly^2*PWM1^2*PWM2^2 + Ly^2*PWM1^2*PWM3^2 + Ly^2*PWM2^2*PWM4^2 + Ly^2*PWM3^2*PWM4^2)) - (TN*(Lx*PWM1^2*PWM2 + Lx*PWM2*PWM3^2))/(2*k1*(Lx^2*PWM1^2*PWM2^2 + Lx^2*PWM1^2*PWM4^2 + Lx^2*PWM2^2*PWM3^2 + Lx^2*PWM3^2*PWM4^2 + Ly^2*PWM1^2*PWM2^2 + Ly^2*PWM1^2*PWM3^2 + Ly^2*PWM2^2*PWM4^2 + Ly^2*PWM3^2*PWM4^2)) - (FX*(Lx*PWM1^2*PWM2 + Lx*PWM2*PWM3^2)*(Ly*PWM1^2 - Ly*PWM2^2 - Ly*PWM3^2 + Ly*PWM4^2))/(2*k1*(PWM1^2 + PWM2^2 + PWM3^2 + PWM4^2)*(Lx^2*PWM1^2*PWM2^2 + Lx^2*PWM1^2*PWM4^2 + Lx^2*PWM2^2*PWM3^2 + Lx^2*PWM3^2*PWM4^2 + Ly^2*PWM1^2*PWM2^2 + Ly^2*PWM1^2*PWM3^2 + Ly^2*PWM2^2*PWM4^2 + Ly^2*PWM3^2*PWM4^2)), (TN*(Ly*PWM1^2*PWM2 + Ly*PWM2*PWM4^2))/(2*k1*(Lx^2*PWM1^2*PWM2^2 + Lx^2*PWM1^2*PWM4^2 + Lx^2*PWM2^2*PWM3^2 + Lx^2*PWM3^2*PWM4^2 + Ly^2*PWM1^2*PWM2^2 + Ly^2*PWM1^2*PWM3^2 + Ly^2*PWM2^2*PWM4^2 + Ly^2*PWM3^2*PWM4^2)) + (FX*(Ly^2*PWM1^4*PWM2 + Ly^2*PWM2*PWM4^4 + 2*Lx^2*PWM1^2*PWM2^3 + 2*Lx^2*PWM2^3*PWM3^2 + Ly^2*PWM1^2*PWM2^3 + Ly^2*PWM2^3*PWM4^2 + 2*Lx^2*PWM1^2*PWM2*PWM4^2 + 2*Lx^2*PWM2*PWM3^2*PWM4^2 + Ly^2*PWM1^2*PWM2*PWM3^2 + 2*Ly^2*PWM1^2*PWM2*PWM4^2 + Ly^2*PWM2*PWM3^2*PWM4^2))/(2*k1*(PWM1^2 + PWM2^2 + PWM3^2 + PWM4^2)*(Lx^2*PWM1^2*PWM2^2 + Lx^2*PWM1^2*PWM4^2 + Lx^2*PWM2^2*PWM3^2 + Lx^2*PWM3^2*PWM4^2 + Ly^2*PWM1^2*PWM2^2 + Ly^2*PWM1^2*PWM3^2 + Ly^2*PWM2^2*PWM4^2 + Ly^2*PWM3^2*PWM4^2)) - (FY*(Ly*PWM1^2*PWM2 + Ly*PWM2*PWM4^2)*(Lx*PWM1^2 - Lx*PWM2^2 + Lx*PWM3^2 - Lx*PWM4^2))/(2*k1*(PWM1^2 + PWM2^2 + PWM3^2 + PWM4^2)*(Lx^2*PWM1^2*PWM2^2 + Lx^2*PWM1^2*PWM4^2 + Lx^2*PWM2^2*PWM3^2 + Lx^2*PWM3^2*PWM4^2 + Ly^2*PWM1^2*PWM2^2 + Ly^2*PWM1^2*PWM3^2 + Ly^2*PWM2^2*PWM4^2 + Ly^2*PWM3^2*PWM4^2)));
theta(3) = atan2((TN*(Lx*PWM2^2*PWM3 + Lx*PWM3*PWM4^2))/(2*k1*(Lx^2*PWM1^2*PWM2^2 + Lx^2*PWM1^2*PWM4^2 + Lx^2*PWM2^2*PWM3^2 + Lx^2*PWM3^2*PWM4^2 + Ly^2*PWM1^2*PWM2^2 + Ly^2*PWM1^2*PWM3^2 + Ly^2*PWM2^2*PWM4^2 + Ly^2*PWM3^2*PWM4^2)) + (FY*(Lx^2*PWM2^4*PWM3 + Lx^2*PWM3*PWM4^4 + Lx^2*PWM2^2*PWM3^3 + Lx^2*PWM3^3*PWM4^2 + 2*Ly^2*PWM1^2*PWM3^3 + 2*Ly^2*PWM3^3*PWM4^2 + Lx^2*PWM1^2*PWM2^2*PWM3 + Lx^2*PWM1^2*PWM3*PWM4^2 + 2*Lx^2*PWM2^2*PWM3*PWM4^2 + 2*Ly^2*PWM1^2*PWM2^2*PWM3 + 2*Ly^2*PWM2^2*PWM3*PWM4^2))/(2*k1*(PWM1^2 + PWM2^2 + PWM3^2 + PWM4^2)*(Lx^2*PWM1^2*PWM2^2 + Lx^2*PWM1^2*PWM4^2 + Lx^2*PWM2^2*PWM3^2 + Lx^2*PWM3^2*PWM4^2 + Ly^2*PWM1^2*PWM2^2 + Ly^2*PWM1^2*PWM3^2 + Ly^2*PWM2^2*PWM4^2 + Ly^2*PWM3^2*PWM4^2)) + (FX*(Lx*PWM2^2*PWM3 + Lx*PWM3*PWM4^2)*(Ly*PWM1^2 - Ly*PWM2^2 - Ly*PWM3^2 + Ly*PWM4^2))/(2*k1*(PWM1^2 + PWM2^2 + PWM3^2 + PWM4^2)*(Lx^2*PWM1^2*PWM2^2 + Lx^2*PWM1^2*PWM4^2 + Lx^2*PWM2^2*PWM3^2 + Lx^2*PWM3^2*PWM4^2 + Ly^2*PWM1^2*PWM2^2 + Ly^2*PWM1^2*PWM3^2 + Ly^2*PWM2^2*PWM4^2 + Ly^2*PWM3^2*PWM4^2)), (TN*(Ly*PWM1^2*PWM3 + Ly*PWM3*PWM4^2))/(2*k1*(Lx^2*PWM1^2*PWM2^2 + Lx^2*PWM1^2*PWM4^2 + Lx^2*PWM2^2*PWM3^2 + Lx^2*PWM3^2*PWM4^2 + Ly^2*PWM1^2*PWM2^2 + Ly^2*PWM1^2*PWM3^2 + Ly^2*PWM2^2*PWM4^2 + Ly^2*PWM3^2*PWM4^2)) + (FX*(Ly^2*PWM1^4*PWM3 + Ly^2*PWM3*PWM4^4 + 2*Lx^2*PWM2^2*PWM3^3 + 2*Lx^2*PWM3^3*PWM4^2 + Ly^2*PWM1^2*PWM3^3 + Ly^2*PWM3^3*PWM4^2 + 2*Lx^2*PWM1^2*PWM2^2*PWM3 + 2*Lx^2*PWM1^2*PWM3*PWM4^2 + Ly^2*PWM1^2*PWM2^2*PWM3 + 2*Ly^2*PWM1^2*PWM3*PWM4^2 + Ly^2*PWM2^2*PWM3*PWM4^2))/(2*k1*(PWM1^2 + PWM2^2 + PWM3^2 + PWM4^2)*(Lx^2*PWM1^2*PWM2^2 + Lx^2*PWM1^2*PWM4^2 + Lx^2*PWM2^2*PWM3^2 + Lx^2*PWM3^2*PWM4^2 + Ly^2*PWM1^2*PWM2^2 + Ly^2*PWM1^2*PWM3^2 + Ly^2*PWM2^2*PWM4^2 + Ly^2*PWM3^2*PWM4^2)) - (FY*(Ly*PWM1^2*PWM3 + Ly*PWM3*PWM4^2)*(Lx*PWM1^2 - Lx*PWM2^2 + Lx*PWM3^2 - Lx*PWM4^2))/(2*k1*(PWM1^2 + PWM2^2 + PWM3^2 + PWM4^2)*(Lx^2*PWM1^2*PWM2^2 + Lx^2*PWM1^2*PWM4^2 + Lx^2*PWM2^2*PWM3^2 + Lx^2*PWM3^2*PWM4^2 + Ly^2*PWM1^2*PWM2^2 + Ly^2*PWM1^2*PWM3^2 + Ly^2*PWM2^2*PWM4^2 + Ly^2*PWM3^2*PWM4^2)));
theta(4) = atan2((FY*(Lx^2*PWM1^4*PWM4 + Lx^2*PWM3^4*PWM4 + Lx^2*PWM1^2*PWM4^3 + Lx^2*PWM3^2*PWM4^3 + 2*Ly^2*PWM2^2*PWM4^3 + 2*Ly^2*PWM3^2*PWM4^3 + Lx^2*PWM1^2*PWM2^2*PWM4 + 2*Lx^2*PWM1^2*PWM3^2*PWM4 + Lx^2*PWM2^2*PWM3^2*PWM4 + 2*Ly^2*PWM1^2*PWM2^2*PWM4 + 2*Ly^2*PWM1^2*PWM3^2*PWM4))/(2*k1*(PWM1^2 + PWM2^2 + PWM3^2 + PWM4^2)*(Lx^2*PWM1^2*PWM2^2 + Lx^2*PWM1^2*PWM4^2 + Lx^2*PWM2^2*PWM3^2 + Lx^2*PWM3^2*PWM4^2 + Ly^2*PWM1^2*PWM2^2 + Ly^2*PWM1^2*PWM3^2 + Ly^2*PWM2^2*PWM4^2 + Ly^2*PWM3^2*PWM4^2)) - (TN*(Lx*PWM1^2*PWM4 + Lx*PWM3^2*PWM4))/(2*k1*(Lx^2*PWM1^2*PWM2^2 + Lx^2*PWM1^2*PWM4^2 + Lx^2*PWM2^2*PWM3^2 + Lx^2*PWM3^2*PWM4^2 + Ly^2*PWM1^2*PWM2^2 + Ly^2*PWM1^2*PWM3^2 + Ly^2*PWM2^2*PWM4^2 + Ly^2*PWM3^2*PWM4^2)) - (FX*(Lx*PWM1^2*PWM4 + Lx*PWM3^2*PWM4)*(Ly*PWM1^2 - Ly*PWM2^2 - Ly*PWM3^2 + Ly*PWM4^2))/(2*k1*(PWM1^2 + PWM2^2 + PWM3^2 + PWM4^2)*(Lx^2*PWM1^2*PWM2^2 + Lx^2*PWM1^2*PWM4^2 + Lx^2*PWM2^2*PWM3^2 + Lx^2*PWM3^2*PWM4^2 + Ly^2*PWM1^2*PWM2^2 + Ly^2*PWM1^2*PWM3^2 + Ly^2*PWM2^2*PWM4^2 + Ly^2*PWM3^2*PWM4^2)), (FX*(Ly^2*PWM2^4*PWM4 + Ly^2*PWM3^4*PWM4 + 2*Lx^2*PWM1^2*PWM4^3 + 2*Lx^2*PWM3^2*PWM4^3 + Ly^2*PWM2^2*PWM4^3 + Ly^2*PWM3^2*PWM4^3 + 2*Lx^2*PWM1^2*PWM2^2*PWM4 + 2*Lx^2*PWM2^2*PWM3^2*PWM4 + Ly^2*PWM1^2*PWM2^2*PWM4 + Ly^2*PWM1^2*PWM3^2*PWM4 + 2*Ly^2*PWM2^2*PWM3^2*PWM4))/(2*k1*(PWM1^2 + PWM2^2 + PWM3^2 + PWM4^2)*(Lx^2*PWM1^2*PWM2^2 + Lx^2*PWM1^2*PWM4^2 + Lx^2*PWM2^2*PWM3^2 + Lx^2*PWM3^2*PWM4^2 + Ly^2*PWM1^2*PWM2^2 + Ly^2*PWM1^2*PWM3^2 + Ly^2*PWM2^2*PWM4^2 + Ly^2*PWM3^2*PWM4^2)) - (TN*(Ly*PWM2^2*PWM4 + Ly*PWM3^2*PWM4))/(2*k1*(Lx^2*PWM1^2*PWM2^2 + Lx^2*PWM1^2*PWM4^2 + Lx^2*PWM2^2*PWM3^2 + Lx^2*PWM3^2*PWM4^2 + Ly^2*PWM1^2*PWM2^2 + Ly^2*PWM1^2*PWM3^2 + Ly^2*PWM2^2*PWM4^2 + Ly^2*PWM3^2*PWM4^2)) + (FY*(Ly*PWM2^2*PWM4 + Ly*PWM3^2*PWM4)*(Lx*PWM1^2 - Lx*PWM2^2 + Lx*PWM3^2 - Lx*PWM4^2))/(2*k1*(PWM1^2 + PWM2^2 + PWM3^2 + PWM4^2)*(Lx^2*PWM1^2*PWM2^2 + Lx^2*PWM1^2*PWM4^2 + Lx^2*PWM2^2*PWM3^2 + Lx^2*PWM3^2*PWM4^2 + Ly^2*PWM1^2*PWM2^2 + Ly^2*PWM1^2*PWM3^2 + Ly^2*PWM2^2*PWM4^2 + Ly^2*PWM3^2*PWM4^2)));


F_out(1) = PWM1*k1*cos(Theta1) + PWM2*k2*cos(Theta2) + PWM3*k3*cos(Theta3) + PWM4*k4*cos(Theta4);
F_out(2) = PWM1*k1*sin(Theta1) + PWM2*k2*sin(Theta2) + PWM3*k3*sin(Theta3) + PWM4*k4*sin(Theta4);
F_out(3) = Lx*(PWM1*k1*sin(Theta1) - PWM2*k2*sin(Theta2) + PWM3*k3*sin(Theta3) - PWM4*k4*sin(Theta4)) - Ly*(PWM1*k1*cos(Theta1) - PWM2*k2*cos(Theta2) - PWM3*k3*cos(Theta3) + PWM4*k4*cos(Theta4));

